
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://manoli-iborra.github.io/NLP/p5.html">
      
      <link rel="icon" href="imagenes/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>5. PLN con Redes neuronales - Procesamiento del Lenguaje Natural</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      

  


  

  



    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-blue" data-md-color-accent="deep-orange">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pln-con-redes-neuronales" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="index.html" title="Procesamiento del Lenguaje Natural" class="md-header__button md-logo" aria-label="Procesamiento del Lenguaje Natural" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Procesamiento del Lenguaje Natural
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. PLN con Redes neuronales 
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Procesamiento del Lenguaje Natural" class="md-nav__button md-logo" aria-label="Procesamiento del Lenguaje Natural" data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    Procesamiento del Lenguaje Natural
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        1. Procesamiento del Lenguaje Natural
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="p1.html" class="md-nav__link">
        2. Librerías para PLN
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="p.html" class="md-nav__link">
        3. Embedding
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="p4.html" class="md-nav__link">
        4. Análisis de sentimiento
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          5. PLN con Redes neuronales 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="p5.html" class="md-nav__link md-nav__link--active">
        5. PLN con Redes neuronales 
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#redes-neuronales-recurrentes-rnr" class="md-nav__link">
    Redes Neuronales Recurrentes (RNR)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redes-neuronales-convolucionales" class="md-nav__link">
    Redes Neuronales Convolucionales
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#redes-neuronales-recurrentes-rnr" class="md-nav__link">
    Redes Neuronales Recurrentes (RNR)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redes-neuronales-convolucionales" class="md-nav__link">
    Redes Neuronales Convolucionales
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="pln-con-redes-neuronales"><strong>PLN con Redes Neuronales</strong><a class="headerlink" href="#pln-con-redes-neuronales" title="Permanent link">&para;</a></h1>
<p>Las redes neuronales son una estructura de neuronas interconectaddas entre sí que procesan datos de manera similar al cerebro humano.</p>
<p>La composición de las redes neuronales es la siguiente:</p>
<ul>
<li>
<p>Capa de entrada: recibe los datos iniciales.</p>
</li>
<li>
<p>Capas ocultas: Procesan la información en base a las salidas de la capa anterior y generan representaciones intermedias.</p>
</li>
<li>
<p>Capa de salida: genera la predicción o resultado final. Requiere tantas neuronas como salidas necesitemos.</p>
</li>
</ul>
<p><img alt="imagen" src="imagenes/redes.PNG" /></p>
<h3 id="redes-neuronales-recurrentes-rnr"><strong>Redes Neuronales Recurrentes (RNR)</strong><a class="headerlink" href="#redes-neuronales-recurrentes-rnr" title="Permanent link">&para;</a></h3>
<p>Las Redes Neuronales Recurrentes son un tipo de arquitectura diseñada para manejar datos con formato de <strong>secuencia</strong> como textos, audios o series temporales.</p>
<p>Estas redes permiten mantener una especie de "memoria" de las entradas anteriores mientras se procesan las entradas actuales.</p>
<p>Una red recurrente es capaz de procesar varias palabras a la vez y por tanto entender mejor el contexto de cada palabra.</p>
<p><img alt="imagen" src="imagenes/redes2.PNG" /></p>
<p><img alt="imagen" src="imagenes/recu.PNG" /></p>
<p>Algunos tipos de Redes Neuronales Recurrentes:</p>
<ul>
<li>
<p><strong>RNN estándar:</strong> También conocida como RNN de bucle simple, es la forma más básica de RNN. Tiene conexiones de retroalimentación que permiten que la salida de una capa se retroalimente como entrada en la siguiente iteración de tiempo.</p>
</li>
<li>
<p><strong>LSTM (Long Short-Term Memory):</strong> Las LSTM son una variante de las RNN diseñada para abordar el problema del desvanecimiento del gradiente y capturar dependencias a largo plazo de manera más efectiva. Introducen unidades de memoria que permiten a la red aprender qué información retener y qué olvidar a lo largo del tiempo.</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">LSTM</span>
<span class="linenos" data-linenos="2 "></span><span class="n">red</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
</code></pre></div>
<ul>
<li><strong>GRU (Gated Recurrent Unit):</strong> Similar a las LSTM, las GRU son otra variante de las RNN que también abordan el problema del desvanecimiento del gradiente. Tienen una estructura más simple que las LSTM, con menos parámetros, lo que puede llevar a un entrenamiento más rápido y eficiente en algunos casos.</li>
</ul>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">GRU</span>
<span class="linenos" data-linenos="2 "></span><span class="n">red</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">GRU</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="c1"># Importar las bibliotecas necesarias</span>
<span class="linenos" data-linenos=" 2 "></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos" data-linenos=" 3 "></span><span class="kn">from</span> <span class="nn">tensorflow.keras.datasets</span> <span class="kn">import</span> <span class="n">imdb</span>
<span class="linenos" data-linenos=" 4 "></span><span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.sequence</span> <span class="kn">import</span> <span class="n">pad_sequences</span>
<span class="linenos" data-linenos=" 5 "></span><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="linenos" data-linenos=" 6 "></span><span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">SimpleRNN</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="c1"># Definir los parámetros</span>
<span class="linenos" data-linenos=" 9 "></span><span class="n">max_features</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># Número máximo de palabras a considerar como características</span>
<span class="linenos" data-linenos="10 "></span><span class="n">maxlen</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Truncar secuencias después de este número de pasos de tiempo</span>
<span class="linenos" data-linenos="11 "></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="linenos" data-linenos="12 "></span>
<span class="linenos" data-linenos="13 "></span><span class="c1"># Cargar los datos</span>
<span class="linenos" data-linenos="14 "></span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">imdb</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="n">max_features</span><span class="p">)</span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="c1"># Preprocesar los datos</span>
<span class="linenos" data-linenos="17 "></span><span class="n">x_train</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span>
<span class="linenos" data-linenos="18 "></span><span class="n">x_test</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="n">maxlen</span><span class="p">)</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="c1"># Construir el modelo</span>
<span class="linenos" data-linenos="21 "></span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="linenos" data-linenos="22 "></span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Embedding</span><span class="p">(</span><span class="n">max_features</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<span class="linenos" data-linenos="23 "></span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">SimpleRNN</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
<span class="linenos" data-linenos="24 "></span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">))</span>
<span class="linenos" data-linenos="25 "></span>
<span class="linenos" data-linenos="26 "></span><span class="c1"># Compilar el modelo</span>
<span class="linenos" data-linenos="27 "></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;acc&#39;</span><span class="p">])</span>
<span class="linenos" data-linenos="28 "></span>
<span class="linenos" data-linenos="29 "></span><span class="c1"># Entrenar el modelo</span>
<span class="linenos" data-linenos="30 "></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="linenos" data-linenos="31 "></span>
<span class="linenos" data-linenos="32 "></span><span class="c1"># Evaluar el modelo</span>
<span class="linenos" data-linenos="33 "></span><span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="linenos" data-linenos="34 "></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test accuracy:&#39;</span><span class="p">,</span> <span class="n">test_acc</span><span class="p">)</span>
<span class="linenos" data-linenos="35 "></span>
<span class="linenos" data-linenos="36 "></span><span class="c1"># Guardar el modelo</span>
<span class="linenos" data-linenos="37 "></span>
<span class="linenos" data-linenos="38 "></span><span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;sentiment_model1.h5&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="39 "></span>
<span class="linenos" data-linenos="40 "></span><span class="c1"># Probar con otro conjunto de datos</span>
<span class="linenos" data-linenos="41 "></span>
<span class="linenos" data-linenos="42 "></span><span class="c1"># Cargar el modelo</span>
<span class="linenos" data-linenos="43 "></span>
<span class="linenos" data-linenos="44 "></span><span class="c1"># Cargar el modelo previamente entrenado</span>
<span class="linenos" data-linenos="45 "></span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;/content/rnn_sentiment_model.h5&#39;</span><span class="p">)</span>  <span class="c1"># Reemplaza &#39;rnn_sentiment_model.h5&#39; con el nombre de tu archivo de modelo</span>
<span class="linenos" data-linenos="46 "></span>
<span class="linenos" data-linenos="47 "></span><span class="c1"># Imprimir las 10 primeras listas del conjunto de entrenamiento</span>
<span class="linenos" data-linenos="48 "></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="linenos" data-linenos="49 "></span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Secuencia </span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">x_train</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos" data-linenos="50 "></span>
<span class="linenos" data-linenos="51 "></span>
<span class="linenos" data-linenos="52 "></span><span class="c1"># Tus propias revisiones de películas</span>
<span class="linenos" data-linenos="53 "></span><span class="n">reviews</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos" data-linenos="54 "></span>    <span class="s2">&quot;This movie was fantastic&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="55 "></span>    <span class="s2">&quot;solid performances in this straightforward adaption&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="56 "></span>    <span class="s2">&quot;brilliant documentary&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="57 "></span>    <span class="s2">&quot;worst mistake of my life&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="58 "></span><span class="p">]</span>
<span class="linenos" data-linenos="59 "></span>
<span class="linenos" data-linenos="60 "></span><span class="c1"># Tokeniza tus revisiones utilizando el mismo Tokenizer que usaste para el modelo</span>
<span class="linenos" data-linenos="61 "></span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>  <span class="c1"># Asegúrate de que coincida con el valor que usaste para entrenar el modelo</span>
<span class="linenos" data-linenos="62 "></span><span class="n">tokenizer</span><span class="o">.</span><span class="n">fit_on_texts</span><span class="p">(</span><span class="n">reviews</span><span class="p">)</span>
<span class="linenos" data-linenos="63 "></span><span class="n">sequences</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">texts_to_sequences</span><span class="p">(</span><span class="n">reviews</span><span class="p">)</span>
<span class="linenos" data-linenos="64 "></span>
<span class="linenos" data-linenos="65 "></span><span class="c1"># Asegúrate de que todas las secuencias tengan la misma longitud</span>
<span class="linenos" data-linenos="66 "></span><span class="n">max_sequence_length</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Asegúrate de que coincida con el valor que usaste para entrenar el modelo</span>
<span class="linenos" data-linenos="67 "></span><span class="n">sequences</span> <span class="o">=</span> <span class="n">pad_sequences</span><span class="p">(</span><span class="n">sequences</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="n">max_sequence_length</span><span class="p">)</span>
<span class="linenos" data-linenos="68 "></span>
<span class="linenos" data-linenos="69 "></span><span class="c1"># Realiza predicciones en tus propias revisiones</span>
<span class="linenos" data-linenos="70 "></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sequences</span><span class="p">)</span>
<span class="linenos" data-linenos="71 "></span>
<span class="linenos" data-linenos="72 "></span><span class="c1"># Muestra las predicciones</span>
<span class="linenos" data-linenos="73 "></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">predictions</span><span class="p">):</span>
<span class="linenos" data-linenos="74 "></span>    <span class="n">sentiment</span> <span class="o">=</span> <span class="s2">&quot;positivo&quot;</span> <span class="k">if</span> <span class="n">prediction</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="s2">&quot;negativo&quot;</span>
<span class="linenos" data-linenos="75 "></span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sentimiento de tu revisión </span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">sentiment</span><span class="si">}</span><span class="s2"> (Puntuación: </span><span class="si">{</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="redes-neuronales-convolucionales"><strong>Redes Neuronales Convolucionales</strong><a class="headerlink" href="#redes-neuronales-convolucionales" title="Permanent link">&para;</a></h3>
<p>La <strong>convolución</strong> es una operación matemática que se utiliza para extraer características importantes de los datos. Se utiliza mucho en el tratamiento de imágenes.</p>
<p>Las CNN están formadas por tres tipos principales de capas:</p>
<ul>
<li>
<p><strong>Capa convolucional:</strong> Es la primera capa de una red convolucional. Realiza la mayoría de los cálculos y se encarga de identificar características locales. </p>
</li>
<li>
<p><strong>Capa de activación:</strong> añaden funciones no lineales para permitir la aproximación de funciones más complejas.</p>
</li>
<li>
<p><strong>Capa de agrupación (pooling):</strong> Reduce la dimensionalidad de los datos y extrae características más complejas.</p>
</li>
<li>
<p><strong>Capa totalmente conectada:</strong> La última capa que procesa la información y produce la salida final.</p>
</li>
</ul>
<p><img alt="imagen" src="imagenes/convo.PNG" /></p>
<p>A medida que los datos de la imagen avanzan a través de estas capas, la CNN reconoce elementos o formas más grandes, hasta identificar el objeto deseado.</p>
<p>En el PLN se utilizan estas redes para aprender características locales y globales del texto.</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="linenos" data-linenos="2 "></span><span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">Conv1D</span><span class="p">,</span> <span class="n">GlobalMaxPooling1D</span>
</code></pre></div>
Construimos la red de forma secuencial</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">red</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
</code></pre></div>
Añadimos la capa de embedding</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">red</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Embedding</span><span class="p">(</span><span class="n">tamano_vocabulario</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
</code></pre></div>
Añadimos una capa de convoluciones con 64 filtros convolucionales de tamaño 5.
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">red</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv1D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
</code></pre></div>
Reducimos la dimensionalidad con pooling</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">red</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">GlobalMaxPooling1D</span><span class="p">())</span>
</code></pre></div>
Añadimos una capa densa de 32 neuronas para procesar las representaciones obtenidas.</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">red</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
</code></pre></div>
Por último haremos que nuestra red termine en una única neurona con una función de activación sigmoidal que hará que los resultados estén próximos a los extremos, es decir, a 0 o a 1. Al final lo que queremos es que la red nos clasifique las reseñas como positivas o negativas</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">red</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">))</span>
</code></pre></div>
Le indicamos el optimizador que debe usar para reducir la pérdida y el tipo de métrica
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">red</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</code></pre></div>
Entrenamos el modelo</p>
<p><div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">red</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</code></pre></div>
Evaluamos el modelo</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">loss</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">red</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Tasa de acierto: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pie">
      
        
        <a href="p4.html" class="md-footer__link md-footer__link--prev" aria-label="Anterior: 4. Análisis de sentimiento" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              4. Análisis de sentimiento
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            2024-2025 Manuela Iborra - Licencia CC BY-NC-SA
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="mailto:<m.iborra@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M400 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM178.117 262.104C87.429 196.287 88.353 196.121 64 177.167V152c0-13.255 10.745-24 24-24h272c13.255 0 24 10.745 24 24v25.167c-24.371 18.969-23.434 19.124-114.117 84.938-10.5 7.655-31.392 26.12-45.883 25.894-14.503.218-35.367-18.227-45.883-25.895zM384 217.775V360c0 13.255-10.745 24-24 24H88c-13.255 0-24-10.745-24-24V217.775c13.958 10.794 33.329 25.236 95.303 70.214 14.162 10.341 37.975 32.145 64.694 32.01 26.887.134 51.037-22.041 64.72-32.025 61.958-44.965 81.325-59.406 95.283-70.199z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "navigation.expand"], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.756773cc.min.js"></script>
      
    
  </body>
</html>